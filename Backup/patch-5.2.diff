diff -ruN /mnt/data/_spolek51_orig/includes/class-spolek-admin.php /mnt/data/_spolek51/includes/class-spolek-admin.php
--- /mnt/data/_spolek51_orig/includes/class-spolek-admin.php	1970-01-01 00:00:00.000000000 +0000
+++ /mnt/data/_spolek51/includes/class-spolek-admin.php	2026-02-25 07:33:37.613084106 +0000
@@ -0,0 +1,80 @@
+<?php
+if (!defined('ABSPATH')) exit;
+
+/**
+ * Společné utility pro admin_post handlery (auth, nonce, redirecty, helpery).
+ *
+ * Cíl: aby controllery nemusely sahat do Spolek_Hlasovani_MVP (legacy).
+ */
+final class Spolek_Admin {
+
+    public static function is_manager(): bool {
+        if (!is_user_logged_in()) return false;
+        if (current_user_can(Spolek_Config::CAP_MANAGE)) return true;
+
+        // fallback na roli podle názvu (kdyby capability nebyla přiřazena)
+        $user = wp_get_current_user();
+        return in_array('spravce_hlasovani', (array)$user->roles, true);
+    }
+
+    public static function require_manager(): void {
+        if (!is_user_logged_in() || !self::is_manager()) {
+            wp_die('Nemáte oprávnění.');
+        }
+    }
+
+    public static function require_login(): void {
+        if (!is_user_logged_in()) {
+            wp_die('Musíte být přihlášeni.');
+        }
+    }
+
+    public static function verify_nonce_post(string $action, string $field = '_nonce'): void {
+        $nonce = isset($_POST[$field]) ? (string)$_POST[$field] : '';
+        if ($nonce === '' || !wp_verify_nonce($nonce, $action)) {
+            wp_die('Neplatný nonce.');
+        }
+    }
+
+    public static function verify_nonce_get(string $action, string $field = '_nonce'): void {
+        $nonce = isset($_GET[$field]) ? (string)$_GET[$field] : '';
+        if ($nonce === '' || !wp_verify_nonce($nonce, $action)) {
+            wp_die('Neplatný nonce.');
+        }
+    }
+
+    public static function get_return_to(string $fallback): string {
+        $rt = isset($_POST['return_to']) ? esc_url_raw((string)$_POST['return_to']) : '';
+        if ($rt) return $rt;
+
+        $ref = wp_get_referer();
+        if ($ref) return $ref;
+
+        return $fallback;
+    }
+
+    public static function redirect_with_error(string $return_to, string $msg): void {
+        wp_safe_redirect(add_query_arg('err', rawurlencode($msg), $return_to));
+        exit;
+    }
+
+    public static function redirect_detail_error(string $return_to, int $vote_post_id, string $msg): void {
+        wp_safe_redirect(add_query_arg(['spolek_vote' => $vote_post_id, 'err' => rawurlencode($msg)], $return_to));
+        exit;
+    }
+
+    /** upcoming | open | closed */
+    public static function vote_status(int $start_ts, int $end_ts): string {
+        $now = time();
+        if ($now < $start_ts) return 'upcoming';
+        if ($now < $end_ts) return 'open';
+        return 'closed';
+    }
+
+    /** @return array{0:int,1:int} [start_ts,end_ts] */
+    public static function vote_times(int $post_id): array {
+        $start_ts = (int) get_post_meta($post_id, '_spolek_start_ts', true);
+        $end_ts   = (int) get_post_meta($post_id, '_spolek_end_ts', true);
+        return [$start_ts, $end_ts];
+    }
+}
diff -ruN /mnt/data/_spolek51_orig/includes/class-spolek-archive-controller.php /mnt/data/_spolek51/includes/class-spolek-archive-controller.php
--- /mnt/data/_spolek51_orig/includes/class-spolek-archive-controller.php	2026-02-24 09:57:31.000000000 +0000
+++ /mnt/data/_spolek51/includes/class-spolek-archive-controller.php	2026-02-25 07:33:04.930724836 +0000
@@ -9,11 +9,193 @@
         if (self::$registered) return;
         self::$registered = true;
 
-        add_action('admin_post_spolek_archive_vote',         [Spolek_Hlasovani_MVP::class, 'handle_archive_vote']);
-        add_action('admin_post_spolek_download_archive',     [Spolek_Hlasovani_MVP::class, 'handle_download_archive']);
-        add_action('admin_post_spolek_purge_vote',           [Spolek_Hlasovani_MVP::class, 'handle_purge_vote']);
-        add_action('admin_post_spolek_run_purge_scan',       [Spolek_Hlasovani_MVP::class, 'handle_run_purge_scan']);
-        add_action('admin_post_spolek_run_close_scan',       [Spolek_Hlasovani_MVP::class, 'handle_run_close_scan']);
-        add_action('admin_post_spolek_test_archive_storage', [Spolek_Hlasovani_MVP::class, 'handle_test_archive_storage']);
+        add_action('admin_post_spolek_archive_vote',         [__CLASS__, 'handle_archive_vote']);
+        add_action('admin_post_spolek_download_archive',     [__CLASS__, 'handle_download_archive']);
+        add_action('admin_post_spolek_purge_vote',           [__CLASS__, 'handle_purge_vote']);
+        add_action('admin_post_spolek_run_purge_scan',       [__CLASS__, 'handle_run_purge_scan']);
+        add_action('admin_post_spolek_run_close_scan',       [__CLASS__, 'handle_run_close_scan']);
+        add_action('admin_post_spolek_test_archive_storage', [__CLASS__, 'handle_test_archive_storage']);
+    }
+
+    public static function handle_archive_vote(): void {
+        Spolek_Admin::require_manager();
+
+        $vote_post_id = (int)($_POST['vote_post_id'] ?? 0);
+        if (!$vote_post_id) wp_die('Neplatné hlasování.');
+
+        Spolek_Admin::verify_nonce_post('spolek_archive_vote_' . $vote_post_id);
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        if (!class_exists('Spolek_Archive')) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Chybí Spolek_Archive.'), $return_to));
+            exit;
+        }
+
+        $res = Spolek_Archive::archive_vote($vote_post_id, true);
+
+        if (is_array($res) && !empty($res['ok'])) {
+            wp_safe_redirect(add_query_arg('archived', '1', $return_to));
+            exit;
+        }
+
+        $err = is_array($res) ? (string)($res['error'] ?? 'Archivace selhala') : 'Archivace selhala';
+        wp_safe_redirect(add_query_arg('err', rawurlencode($err), $return_to));
+        exit;
+    }
+
+    public static function handle_download_archive(): void {
+        Spolek_Admin::require_manager();
+
+        $file = (string)($_GET['file'] ?? '');
+        $vote_post_id = (int)($_GET['vote_post_id'] ?? 0);
+
+        if ($file === '' && $vote_post_id) {
+            $file = (string) get_post_meta($vote_post_id, Spolek_Config::META_ARCHIVE_FILE, true);
+        }
+        $file = basename((string)$file);
+
+        if ($file === '') wp_die('Neplatný soubor.');
+
+        Spolek_Admin::verify_nonce_get('spolek_download_archive_' . $file);
+
+        if (!class_exists('Spolek_Archive')) {
+            wp_die('Chybí Spolek_Archive.');
+        }
+
+        Spolek_Archive::send_archive($file);
+    }
+
+    public static function handle_purge_vote(): void {
+        Spolek_Admin::require_manager();
+
+        $vote_post_id = (int)($_POST['vote_post_id'] ?? 0);
+        if (!$vote_post_id) wp_die('Neplatné hlasování.');
+
+        Spolek_Admin::verify_nonce_post('spolek_purge_vote_' . $vote_post_id);
+
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        if (!class_exists('Spolek_Archive')) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Chybí Spolek_Archive.'), $return_to));
+            exit;
+        }
+
+        $res = Spolek_Archive::purge_vote($vote_post_id);
+
+        if (is_array($res) && !empty($res['ok'])) {
+            wp_safe_redirect(add_query_arg('purged', '1', $return_to));
+            exit;
+        }
+
+        $err = is_array($res) ? (string)($res['error'] ?? 'Purge selhal') : 'Purge selhal';
+        wp_safe_redirect(add_query_arg('err', rawurlencode($err), $return_to));
+        exit;
+    }
+
+    public static function handle_test_archive_storage(): void {
+        Spolek_Admin::require_manager();
+        Spolek_Admin::verify_nonce_post('spolek_test_archive_storage');
+
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        if (!class_exists('Spolek_Archive') || !method_exists('Spolek_Archive', 'test_write')) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Chybí Spolek_Archive::test_write.'), $return_to));
+            exit;
+        }
+
+        $res = [];
+        try {
+            $res = Spolek_Archive::test_write();
+        } catch (Throwable $e) {
+            $res = ['ok' => false, 'error' => $e->getMessage()];
+        }
+
+        $args = [
+            'storage_test' => '1',
+            'storage_test_ok' => !empty($res['ok']) ? '1' : '0',
+        ];
+        if (!empty($res['storage'])) $args['storage_test_storage'] = (string)$res['storage'];
+        if (!empty($res['dir']))     $args['storage_test_dir']     = (string)$res['dir'];
+        if (!empty($res['error']))   $args['storage_test_err']     = (string)$res['error'];
+
+        wp_safe_redirect(add_query_arg($args, $return_to));
+        exit;
+    }
+
+    public static function handle_run_close_scan(): void {
+        Spolek_Admin::require_manager();
+        Spolek_Admin::verify_nonce_post('spolek_run_close_scan');
+
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        if (!class_exists('Spolek_Cron') || !method_exists('Spolek_Cron', 'close_scan')) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Chybí Spolek_Cron::close_scan.'), $return_to));
+            exit;
+        }
+
+        try {
+            $stats = Spolek_Cron::close_scan();
+        } catch (Throwable $e) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Close scan selhal: ' . $e->getMessage()), $return_to));
+            exit;
+        }
+
+        $msg = 'Dohnání uzávěrek: zpracováno ' . (int)($stats['total'] ?? 0)
+             . ' (tichý režim: ' . (int)($stats['silent'] ?? 0)
+             . ', standard: ' . (int)($stats['normal'] ?? 0)
+             . ', chyby: ' . (int)($stats['errors'] ?? 0) . ').';
+
+        wp_safe_redirect(add_query_arg('notice', rawurlencode($msg), $return_to));
+        exit;
+    }
+
+    public static function handle_run_purge_scan(): void {
+        Spolek_Admin::require_manager();
+        Spolek_Admin::verify_nonce_post('spolek_run_purge_scan');
+
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        if (!class_exists('Spolek_Cron') || !method_exists('Spolek_Cron', 'purge_scan')) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Chybí Spolek_Cron::purge_scan.'), $return_to));
+            exit;
+        }
+
+        if (!class_exists('Spolek_Archive')) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Chybí Spolek_Archive.'), $return_to));
+            exit;
+        }
+
+        Spolek_Archive::ensure_storage();
+
+        $before = 0;
+        try {
+            $items = Spolek_Archive::list_archives();
+            $before = count(array_filter($items, static function($it){ return !empty($it['purged_at']); }));
+        } catch (Throwable $e) {
+            $before = 0;
+        }
+
+        try {
+            Spolek_Cron::purge_scan();
+        } catch (Throwable $e) {
+            wp_safe_redirect(add_query_arg('err', rawurlencode('Purge scan selhal: ' . $e->getMessage()), $return_to));
+            exit;
+        }
+
+        $after = $before;
+        try {
+            $items = Spolek_Archive::list_archives();
+            $after = count(array_filter($items, static function($it){ return !empty($it['purged_at']); }));
+        } catch (Throwable $e) {
+            $after = $before;
+        }
+
+        $delta = max(0, (int)$after - (int)$before);
+
+        wp_safe_redirect(add_query_arg([
+            'purge_scan' => '1',
+            'purge_scan_purged' => (string)$delta,
+        ], $return_to));
+        exit;
     }
 }
diff -ruN /mnt/data/_spolek51_orig/includes/class-spolek-plugin.php /mnt/data/_spolek51/includes/class-spolek-plugin.php
--- /mnt/data/_spolek51_orig/includes/class-spolek-plugin.php	2026-02-24 15:16:14.000000000 +0000
+++ /mnt/data/_spolek51/includes/class-spolek-plugin.php	2026-02-25 07:33:15.914856829 +0000
@@ -15,6 +15,7 @@
      */
     private const DEPENDENCIES = [
         'includes/class-spolek-config.php',
+        'includes/class-spolek-admin.php',
         'includes/class-spolek-audit-events.php',
         'includes/class-spolek-audit.php',
         'includes/class-spolek-mailer.php',
@@ -49,7 +50,8 @@
         class_exists('Spolek_Cron') &&
         class_exists('Spolek_Archive') &&
         class_exists('Spolek_Hlasovani_MVP') &&
-        class_exists('Spolek_PDF_Service')
+        class_exists('Spolek_PDF_Service') &&
+        class_exists('Spolek_Admin')
     ) {
         return;
     }
diff -ruN /mnt/data/_spolek51_orig/includes/class-spolek-votes-controller.php /mnt/data/_spolek51/includes/class-spolek-votes-controller.php
--- /mnt/data/_spolek51_orig/includes/class-spolek-votes-controller.php	2026-02-24 09:57:31.000000000 +0000
+++ /mnt/data/_spolek51/includes/class-spolek-votes-controller.php	2026-02-25 07:32:37.602353702 +0000
@@ -9,8 +9,194 @@
         if (self::$registered) return;
         self::$registered = true;
 
-        add_action('admin_post_spolek_create_vote', [Spolek_Hlasovani_MVP::class, 'handle_create_vote']);
-        add_action('admin_post_spolek_cast_vote',   [Spolek_Hlasovani_MVP::class, 'handle_cast_vote']);
-        add_action('admin_post_spolek_export_csv',  [Spolek_Hlasovani_MVP::class, 'handle_export_csv']);
+        add_action('admin_post_spolek_create_vote', [__CLASS__, 'handle_create_vote']);
+        add_action('admin_post_spolek_cast_vote',   [__CLASS__, 'handle_cast_vote']);
+        add_action('admin_post_spolek_export_csv',  [__CLASS__, 'handle_export_csv']);
+    }
+
+    public static function handle_create_vote(): void {
+        Spolek_Admin::require_manager();
+        Spolek_Admin::verify_nonce_post('spolek_create_vote');
+
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        $title = sanitize_text_field($_POST['title'] ?? '');
+        $text  = sanitize_textarea_field($_POST['text'] ?? '');
+        $start = sanitize_text_field($_POST['start'] ?? '');
+        $end   = sanitize_text_field($_POST['end'] ?? '');
+
+        $tz = wp_timezone();
+        $start_dt = DateTimeImmutable::createFromFormat('Y-m-d H:i', $start, $tz);
+        $end_dt   = DateTimeImmutable::createFromFormat('Y-m-d H:i', $end, $tz);
+        $start_ts = $start_dt ? $start_dt->getTimestamp() : 0;
+        $end_ts   = $end_dt ? $end_dt->getTimestamp() : 0;
+
+        if (!$title || !$text || !$start_ts || !$end_ts || $end_ts <= $start_ts) {
+            Spolek_Admin::redirect_with_error($return_to, 'Neplatné údaje (zkontrolujte datum/čas).');
+        }
+
+        $post_id = wp_insert_post([
+            'post_type'   => Spolek_Config::CPT,
+            'post_status' => 'publish',
+            'post_title'  => $title,
+        ], true);
+
+        if (is_wp_error($post_id)) {
+            Spolek_Admin::redirect_with_error($return_to, 'Nelze vytvořit hlasování.');
+        }
+        $post_id = (int) $post_id;
+
+        update_post_meta($post_id, '_spolek_text', $text);
+        update_post_meta($post_id, '_spolek_start_ts', (int)$start_ts);
+        update_post_meta($post_id, '_spolek_end_ts', (int)$end_ts);
+
+        if (class_exists('Spolek_Audit')) {
+            Spolek_Audit::log($post_id, get_current_user_id(), Spolek_Audit_Events::VOTE_CREATED, [
+                'title' => $title,
+            ]);
+        }
+
+        $ruleset = sanitize_text_field($_POST['ruleset'] ?? 'standard');
+        if (!in_array($ruleset, ['standard', 'two_thirds'], true)) $ruleset = 'standard';
+
+        $pass_base = sanitize_text_field($_POST['pass_base'] ?? 'valid');
+        if (!in_array($pass_base, ['valid', 'all'], true)) $pass_base = 'valid';
+
+        $to_ratio = static function($v) {
+            $v = trim((string)$v);
+            if ($v === '') return null;
+            $v = str_replace(',', '.', $v);
+            $r = ((float)$v) / 100.0;
+            if ($r < 0) $r = 0;
+            if ($r > 1) $r = 1;
+            return $r;
+        };
+
+        $quorum_ratio = $to_ratio($_POST['quorum_ratio'] ?? '');
+        $pass_ratio   = $to_ratio($_POST['pass_ratio'] ?? '');
+
+        update_post_meta($post_id, Spolek_Config::META_RULESET, $ruleset);
+        update_post_meta($post_id, Spolek_Config::META_BASE, $pass_base);
+
+        if ($quorum_ratio === null) delete_post_meta($post_id, Spolek_Config::META_QUORUM_RATIO);
+        else update_post_meta($post_id, Spolek_Config::META_QUORUM_RATIO, (string)$quorum_ratio);
+
+        if ($pass_ratio === null) delete_post_meta($post_id, Spolek_Config::META_PASS_RATIO);
+        else update_post_meta($post_id, Spolek_Config::META_PASS_RATIO, (string)$pass_ratio);
+
+        // naplánovat připomínky + výsledek
+        if (class_exists('Spolek_Cron')) {
+            Spolek_Cron::schedule_vote_events($post_id, (int)$start_ts, (int)$end_ts);
+        }
+
+        // odeslat oznámení všem členům
+        if (class_exists('Spolek_Mailer')) {
+            Spolek_Mailer::send_announce($post_id);
+        }
+
+        wp_safe_redirect(add_query_arg('created', '1', $return_to));
+        exit;
+    }
+
+    public static function handle_cast_vote(): void {
+        Spolek_Admin::require_login();
+
+        $return_to = Spolek_Admin::get_return_to(home_url('/clenove/hlasovani/'));
+
+        $vote_post_id = (int)($_POST['vote_post_id'] ?? 0);
+        $choice = sanitize_text_field($_POST['choice'] ?? '');
+        $user_id = get_current_user_id();
+
+        if (class_exists('Spolek_Audit')) {
+            Spolek_Audit::log($vote_post_id ?: 0, $user_id, Spolek_Audit_Events::VOTE_CAST_ATTEMPT, [
+                'choice' => $choice ?: null,
+            ]);
+        }
+
+        if (!$vote_post_id || !in_array($choice, ['ANO','NE','ZDRZEL'], true)) {
+            if (class_exists('Spolek_Audit')) {
+                Spolek_Audit::log($vote_post_id ?: 0, $user_id, Spolek_Audit_Events::VOTE_CAST_REJECTED, [
+                    'reason' => 'invalid_choice_or_vote_id',
+                    'choice' => $choice ?: null,
+                ]);
+            }
+            Spolek_Admin::redirect_detail_error($return_to, $vote_post_id, 'Neplatná volba.');
+        }
+
+        Spolek_Admin::verify_nonce_post('spolek_cast_vote_' . $vote_post_id);
+
+        [$start_ts, $end_ts] = Spolek_Admin::vote_times($vote_post_id);
+        $status = Spolek_Admin::vote_status((int)$start_ts, (int)$end_ts);
+        if ($status !== 'open') {
+            if (class_exists('Spolek_Audit')) {
+                Spolek_Audit::log($vote_post_id, $user_id, Spolek_Audit_Events::VOTE_CAST_REJECTED, [
+                    'reason' => 'not_open',
+                    'status' => $status,
+                ]);
+            }
+            Spolek_Admin::redirect_detail_error($return_to, $vote_post_id, 'Hlasování není otevřené.');
+        }
+
+        if (class_exists('Spolek_Votes') && Spolek_Votes::has_user_voted($vote_post_id, $user_id)) {
+            if (class_exists('Spolek_Audit')) {
+                Spolek_Audit::log($vote_post_id, $user_id, Spolek_Audit_Events::VOTE_CAST_REJECTED, [
+                    'reason' => 'already_voted',
+                ]);
+            }
+            Spolek_Admin::redirect_detail_error($return_to, $vote_post_id, 'Už jste hlasoval(a).');
+        }
+
+        $ok = class_exists('Spolek_Votes') ? Spolek_Votes::insert_vote($vote_post_id, $user_id, $choice) : false;
+
+        if (!$ok) {
+            global $wpdb;
+            if (class_exists('Spolek_Audit')) {
+                Spolek_Audit::log($vote_post_id, $user_id, Spolek_Audit_Events::VOTE_CAST_FAILED, [
+                    'reason'   => 'db_insert_failed',
+                    'db_error' => $wpdb->last_error ?: null,
+                ]);
+            }
+            Spolek_Admin::redirect_detail_error($return_to, $vote_post_id, 'Nelze uložit hlas (možná duplicitní).');
+        }
+
+        if (class_exists('Spolek_Audit')) {
+            Spolek_Audit::log($vote_post_id, $user_id, Spolek_Audit_Events::VOTE_CAST_SAVED, [
+                'choice' => $choice,
+            ]);
+        }
+
+        wp_safe_redirect(add_query_arg(['spolek_vote' => $vote_post_id, 'voted' => '1'], $return_to));
+        exit;
+    }
+
+    public static function handle_export_csv(): void {
+        Spolek_Admin::require_manager();
+
+        $vote_post_id = (int)($_POST['vote_post_id'] ?? 0);
+        if (!$vote_post_id) wp_die('Neplatné hlasování.');
+
+        Spolek_Admin::verify_nonce_post('spolek_export_csv_' . $vote_post_id);
+
+        $rows = class_exists('Spolek_Votes') ? Spolek_Votes::export_rows($vote_post_id) : [];
+
+        $filename = 'hlasovani-' . $vote_post_id . '-hlasy.csv';
+
+        header('Content-Type: text/csv; charset=utf-8');
+        header('Content-Disposition: attachment; filename="'.$filename.'"');
+
+        $out = fopen('php://output', 'w');
+        fputcsv($out, ['user_id','user_email','choice','cast_at']);
+
+        foreach ($rows as $r) {
+            $u = get_user_by('id', (int)($r['user_id'] ?? 0));
+            fputcsv($out, [
+                $r['user_id'] ?? '',
+                $u ? $u->user_email : '',
+                $r['choice'] ?? '',
+                $r['cast_at'] ?? '',
+            ]);
+        }
+        fclose($out);
+        exit;
     }
 }
